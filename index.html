<!DOCTYPE HTML>
<html>
	
<head lang="en">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
	<link href="css/ohmygod.css" rel="stylesheet" type="text/css"/>	
    <title>使用SQLLite数据库实现web留言本</title>
    <script type="text/javascript" src="script4.js"></script>
</head>
	
<body onload="init()">
	 <div class="container">
	 <header class="jumbotron subhead" id="overview">
    <h1>使用SQLLite数据库实现web留言本</h1>
    <table>
        <tr><td>姓名：</td><td><input type="text" id="name"></td></tr>
        <tr><td>留言：</td><td><input type="text" id="memo"></td></tr>
        <tr>
            <td></td>
            <td><input type="button" value="保存" onclick="saveData();"></td>
        </tr>
    </table>
    <hr>
    <table id="dataTable" border="1"></table>
    <p id="msg"></p>
	



     <div class="timer">
            <b id="d"></b> Days <b id="h"></b> Hours <b id="m"></b> Minutes <b id="s"></b> Seconds
        </div>
 </div>
		    
		
    <script>
var dataTable = null;
var db = openDatabase("MsgData", "1.0", "留言表", 1024 * 1024, function () { });

function init(){
    dataTable = document.getElementById("dataTable");
    showAllData();
}

function removeAllData(){
    for(var i = dataTable.childNodes.length-1;i >= 0;i--){
        dataTable.removeChild(dataTable.childNodes[i]);
    }
    var tr = document.createElement('tr');
    var th1 = document.createElement('th');
    var th2 = document.createElement('th');
    var th3 = document.createElement('th');
    th1.innerHTML = '姓名';
    th2.innerHTML = '留言';
    th3.innerHTML = '时间';
    tr.appendChild(th1);
    tr.appendChild(th2);
    tr.appendChild(th3);
    dataTable.appendChild(tr);
}

function showData(row){
    var tr = document.createElement('tr');
    var td1 = document.createElement('td');
    td1.innerHTML = row.name;
    var td2 = document.createElement('td');
    td2.innerHTML = row.message;
    var td3 = document.createElement('td');
    var t = new Date();
    t.setTime(row.time);
    td3.innerHTML = t.toLocaleDateString()+" "+t.toLocaleTimeString();
    tr.appendChild(td1);
    tr.appendChild(td2);
    tr.appendChild(td3);
    dataTable.appendChild(tr);
}

function showAllData(){
    db.transaction(function(tx){
        tx.executeSql('create table if not exists MsgData(name text,message text,time integer',[]);
        tx.executeSql('select * from MsgData',[],function(tx,rs){
            removeAllData();
            for(var i = 0;i < rs.rows.length;i++){
                showData(rs.rows.item[i]);
            }
        });
    });
}

function addData(name,message,time){
    db.transaction(function(tx){
        tx.executeSql(
        'insert into MsgData(name,message,time) values(?,?,?)',
        [name,message,time],
        function(tx,rs){
            alert("成功保存数据！");
        },
        function(tx,error){
            alert(error.source + "::" + error.message);
        }
        );
    });
}

function saveData(){
    var name = document.getElementById('name').value;
    var memo = document.getElementById('memo').value;
    var time = new Date().getTime();
    addData(name,memo,time);
    showAllData();
}
  
	           
    </script>
	
	<div class="container">
		<div class="row">
			<div class="col-xs-4 col-md-4">
				<a href="http://3usen5.lofter.com/" class="thumbnail">
					<img src="img/1.png" title="你">
				</a>
			</div>
			<div class="col-xs-4 col-md-4">
				<a href="http://3usen5.lofter.com/" class="thumbnail">
					<img src="img/2.png" title="爱">
				</a>
			</div>
			<div class="col-xs-4 col-md-4">
				<a href="http://3usen5.lofter.com/" class="thumbnail">
					<img src="img/3.png" title="我">
				</a>
			</div>
		</div>
		<div class="row">
			<div class="col-xs-4 col-md-4">
				<a href="http://3usen5.lofter.com/" class="thumbnail">
					<img src="img/4.png" title="我">
				</a>
			</div>
			<div class="col-xs-4 col-md-4">
				<a href="http://3usen5.lofter.com/" class="thumbnail">
					<img src="img/5.jpg" title="知">
				</a>
			</div>
			<div class="col-xs-4 col-md-4">
				<a href="http://3usen5.lofter.com/" class="thumbnail">
					<img src="img/6.png" title="道">
				</a>
			</div>
		</div>
		<div class="row">
			<div class="col-xs-4 col-md-4">
				<a href="http://3usen5.lofter.com/" class="thumbnail">
					<img src="img/7.png" title="啊">
				</a>
			</div>
			<div class="col-xs-4 col-md-4">
				<a href="http://3usen5.lofter.com/" class="thumbnail">
					<img src="img/8.png" title="呆">
				</a>
			</div>
			<div class="col-xs-4 col-md-4">
				<a href="http://3usen5.lofter.com/" class="thumbnail">
					<img src="img/9.png" title="瓜">
				</a>
			</div>
		</div>
	</div>
	       
<embed height="0" type="audio/mp3" width="0" src="img/MyLittleAirport.mp3" volume="0" loop="true" autostart="true" />
	       
	       <div class="solar-system">

	  </div>
	  </div>
  </div>
	
</body>
</html>

<!DOCTYPE html>
<html lang="cn">
